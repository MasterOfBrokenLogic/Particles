<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fluid Particles Swipe</title>
<style>
html, body {margin:0; padding:0; width:100%; height:100%; background:#111; overflow:hidden;}
canvas {display:block;}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let SPACING = 3, DRAG = 0.9, EASE = 0.2, COLOR = 220;
let particles = [], mx, my, man = false, tx, ty;

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  particles = [];
  const cols = Math.floor(canvas.width / SPACING);
  const rows = Math.floor(canvas.height / SPACING);
  for (let y = 0; y < rows; y++) {
    for (let x = 0; x < cols; x++) {
      particles.push({
        x: x*SPACING + SPACING/2,
        y: y*SPACING + SPACING/2,
        ox: x*SPACING + SPACING/2,
        oy: y*SPACING + SPACING/2,
        vx: 0,
        vy: 0
      });
    }
  }
  tx = canvas.width/2;
  ty = canvas.height/2;
}

window.addEventListener('resize', resize);
resize();

canvas.addEventListener('mousemove', e => {mx = e.clientX; my = e.clientY; man = true;});
canvas.addEventListener('touchmove', e => {
  const t = e.touches[0];
  mx = t.clientX; my = t.clientY; man = true; e.preventDefault();
},{passive:false});

function step() {
  const w = canvas.width, h = canvas.height;

  // Smooth pointer target
  const smoothing = 0.2;
  if(!man){
    const t = +new Date()*0.001;
    mx = w*0.5 + Math.cos(t*2.1)*Math.cos(t*0.9)*w*0.45;
    my = h*0.5 + Math.sin(t*3.2)*Math.tan(Math.sin(t*0.8))*h*0.45;
  }
  tx += (mx - tx)*smoothing;
  ty += (my - ty)*smoothing;

  // Move particles smoothly towards target offset
  const offsetX = tx - w/2;
  const offsetY = ty - h/2;
  for(let i=0;i<particles.length;i++){
    const p = particles[i];
    p.x += (offsetX*0.02) + (p.ox - p.x)*EASE;
    p.y += (offsetY*0.02) + (p.oy - p.y)*EASE;
    p.vx *= DRAG; p.vy *= DRAG;
  }

  // Draw
  const img = ctx.createImageData(w,h);
  const data = img.data;
  for(let i=0;i<particles.length;i++){
    const p = particles[i];
    const n = (~~p.x + ~~p.y*w)*4;
    data[n] = data[n+1] = data[n+2] = COLOR;
    data[n+3] = 255;
  }
  ctx.putImageData(img,0,0);

  requestAnimationFrame(step);
}

step();
</script>
</body>
</html>
